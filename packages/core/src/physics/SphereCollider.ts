import { ISphereCollider } from "@oasis-engine/design";
import { Collider } from "./Collider";
import { Entity } from "../Entity";

export class SphereCollider extends Collider {
  _sphereCollider: ISphereCollider;

  get radius(): number {
    return this._sphereCollider.radius;
  }

  /**
   * set size of collider
   * @param value size of SphereCollider
   */
  set radius(value: number) {
    this._sphereCollider.radius = value;
  }

  constructor(entity: Entity) {
    super(entity);
    this._sphereCollider = this.engine._physicsEngine.createSphereCollider();
    this._collider = this._sphereCollider;
    this._updateFlag = this.entity.transform.registerWorldChangeFlag();
    this._updateFlag.flag = false;
  }

  /**
   * init Collider and alloc PhysX objects.
   * @param value size of SphereCollider
   * @remarks must call after this component add to Entity.
   */
  initWithRadius(value: number) {
    this._sphereCollider.initWithRadius(
      this._index,
      value,
      this.entity.transform.position,
      this.entity.transform.rotationQuaternion
    );
  }
}
